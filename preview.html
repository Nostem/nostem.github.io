<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Nostem Homestead — Design Preview</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Special+Elite&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&display=swap" rel="stylesheet">

  <style>
    /* ========================================
       CSS CUSTOM PROPERTIES — DESIGN TOKENS
       ======================================== */
    :root {
      /* Light Mode — Warm Parchment */
      --color-bg: #faf5eb;
      --color-bg-alt: #f5e8d3;
      --color-surface: #fffdf8;
      --color-text: #3a2a1a;
      --color-text-muted: #7a6b5a;
      --color-heading-1: #5c2d41;
      --color-heading-2: #8b5a2b;
      --color-heading-3: #4a7043;
      --color-heading-4: #a0522d;
      --color-border: #d4c4a8;
      --color-nav-bg: rgba(245, 232, 211, 0.92);
      --color-nav-border: rgba(212, 196, 168, 0.5);
      --color-accent: #8b5a2b;
      --color-link: #5c2d41;
      --color-link-hover: #8b5a2b;
      --shadow-book: 2px 4px 8px rgba(0,0,0,0.15);
      --shadow-book-hover: 5px 10px 20px rgba(0,0,0,0.25);
      --shadow-page: 0 1px 3px rgba(0,0,0,0.08), 0 6px 14px rgba(0,0,0,0.1);
      --grain-opacity: 0.12;
      --grain-blend: multiply;
      --shelf-gradient: linear-gradient(to bottom, #a07840 0%, #7a5230 30%, #6b4226 60%, #5a3520 100%);
      --shelf-lip: linear-gradient(to bottom, #5a3520, #4a2a18);
      --shelf-shadow: 0 6px 16px rgba(0,0,0,0.35), inset 0 -2px 4px rgba(0,0,0,0.15);
      --hero-overlay: rgba(250, 245, 235, 0.6);
      --toggle-bg: rgba(139, 90, 43, 0.12);
      --toggle-hover: rgba(139, 90, 43, 0.22);
      --timeline-line: #d4c4a8;
      --timeline-dot: #8b5a2b;
      --timeline-dot-border: #faf5eb;
    }

    [data-theme="dark"] {
      /* Dark Mode — Candlelight / Firelight */
      --color-bg: #1a130d;
      --color-bg-alt: #231a12;
      --color-surface: #2a1f16;
      --color-text: #e8d5b0;
      --color-text-muted: #a08b6f;
      --color-heading-1: #d4a076;
      --color-heading-2: #c9956b;
      --color-heading-3: #7aad70;
      --color-heading-4: #c87a4a;
      --color-border: #4a3a2a;
      --color-nav-bg: rgba(26, 19, 13, 0.94);
      --color-nav-border: rgba(74, 58, 42, 0.5);
      --color-accent: #c9956b;
      --color-link: #d4a076;
      --color-link-hover: #e8c4a0;
      --shadow-book: 2px 4px 14px rgba(0,0,0,0.5);
      --shadow-book-hover: 5px 10px 24px rgba(0,0,0,0.6);
      --shadow-page: 0 2px 6px rgba(0,0,0,0.3), 0 8px 20px rgba(0,0,0,0.25);
      --grain-opacity: 0.06;
      --grain-blend: soft-light;
      --shelf-gradient: linear-gradient(to bottom, #5a4030 0%, #4a3020 30%, #3a2518 60%, #2a1a10 100%);
      --shelf-lip: linear-gradient(to bottom, #2a1a10, #1a1008);
      --shelf-shadow: 0 6px 16px rgba(0,0,0,0.6), inset 0 -2px 4px rgba(0,0,0,0.3);
      --hero-overlay: rgba(26, 19, 13, 0.65);
      --toggle-bg: rgba(201, 149, 107, 0.15);
      --toggle-hover: rgba(201, 149, 107, 0.25);
      --timeline-line: #4a3a2a;
      --timeline-dot: #c9956b;
      --timeline-dot-border: #1a130d;
    }

    /* ========================================
       RESET & BASE
       ======================================== */
    *, *::before, *::after {
      margin: 0; padding: 0; box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
      font-size: 18px;
    }

    body {
      font-family: 'Lora', Georgia, 'Palatino Linotype', 'Book Antiqua', Palatino, serif;
      color: var(--color-text);
      background-color: var(--color-bg);
      line-height: 1.7;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      transition: background-color 0.5s ease, color 0.4s ease;
      overflow-x: hidden;
    }

    /* Paper grain overlay */
    body::before {
      content: '';
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23n)' opacity='0.15'/%3E%3C/svg%3E");
      background-repeat: repeat;
      opacity: var(--grain-opacity);
      background-blend-mode: var(--grain-blend);
      pointer-events: none;
      z-index: 1;
      transition: opacity 0.5s ease;
    }

    /* ========================================
       TYPOGRAPHY
       ======================================== */
    h1, h2, h3, h4 {
      font-family: 'Special Elite', 'Courier New', Courier, monospace;
      letter-spacing: 0.04em;
      line-height: 1.3;
    }
    h1 { color: var(--color-heading-1); font-size: 2.4rem; margin: 0 0 0.6em; }
    h2 { color: var(--color-heading-2); font-size: 1.8rem; margin: 1.8em 0 0.6em; }
    h3 { color: var(--color-heading-3); font-size: 1.45rem; margin: 1.5em 0 0.5em; }
    h4 { color: var(--color-heading-4); font-size: 1.2rem; margin: 1.2em 0 0.4em; }

    a {
      color: var(--color-link);
      text-decoration: none;
      border-bottom: 1px solid transparent;
      transition: color 0.25s ease, border-color 0.25s ease;
    }
    a:hover {
      color: var(--color-link-hover);
      border-bottom-color: var(--color-link-hover);
    }

    ::selection {
      background: rgba(139, 90, 43, 0.2);
      color: var(--color-text);
    }

    p { margin-bottom: 1em; }
    ul { padding-left: 1.4em; margin-bottom: 1em; }
    li { margin-bottom: 0.35em; }
    li::marker { color: var(--color-accent); }
    strong { color: var(--color-heading-1); }

    /* ========================================
       LAYOUT
       ======================================== */
    .page-container {
      max-width: 820px;
      margin: 0 auto;
      padding: 0 1.5rem;
      position: relative;
      z-index: 2;
    }

    .wide-container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 1.5rem;
      position: relative;
      z-index: 2;
    }

    /* Page content wrapper for transitions */
    .page-content {
      opacity: 0;
      transform: translateY(18px);
      animation: pageEnter 0.55s ease-out forwards;
      min-height: calc(100vh - 180px);
      padding-top: 90px;
      padding-bottom: 4rem;
    }

    @keyframes pageEnter {
      to { opacity: 1; transform: translateY(0); }
    }

    .page-exit {
      animation: pageExit 0.25s ease-in forwards;
    }
    @keyframes pageExit {
      to { opacity: 0; transform: translateY(-10px); }
    }

    /* Sections */
    section {
      margin-bottom: 3.5rem;
    }

    /* ========================================
       NAVIGATION
       ======================================== */
    .site-nav {
      position: fixed;
      top: 0; left: 0; right: 0;
      z-index: 100;
      background: var(--color-nav-bg);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-bottom: 1px solid var(--color-nav-border);
      transition: background 0.4s ease, border-color 0.4s ease, box-shadow 0.3s ease;
    }

    .site-nav.scrolled {
      box-shadow: 0 2px 20px rgba(0,0,0,0.08);
    }

    [data-theme="dark"] .site-nav.scrolled {
      box-shadow: 0 2px 20px rgba(0,0,0,0.3);
    }

    .nav-inner {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 68px;
      transition: height 0.3s ease;
    }

    .site-nav.scrolled .nav-inner {
      height: 56px;
    }

    .nav-brand {
      font-family: 'Special Elite', monospace;
      font-size: 1.3rem;
      color: var(--color-heading-1);
      text-decoration: none;
      border-bottom: none;
      letter-spacing: 0.03em;
      transition: color 0.3s ease, font-size 0.3s ease;
    }
    .nav-brand:hover { color: var(--color-heading-2); border-bottom: none; }

    .site-nav.scrolled .nav-brand { font-size: 1.15rem; }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    .nav-link {
      font-family: 'Lora', Georgia, serif;
      font-size: 0.95rem;
      color: var(--color-text-muted);
      text-decoration: none;
      border-bottom: none;
      position: relative;
      padding-bottom: 4px;
      transition: color 0.25s ease;
      font-weight: 500;
    }
    .nav-link:hover, .nav-link.active {
      color: var(--color-text);
      border-bottom: none;
    }
    .nav-link::after {
      content: '';
      position: absolute;
      bottom: 0; left: 50%; right: 50%;
      height: 2px;
      background: var(--color-accent);
      border-radius: 1px;
      transition: left 0.3s ease, right 0.3s ease;
    }
    .nav-link:hover::after, .nav-link.active::after {
      left: 0; right: 0;
    }

    /* Dark mode toggle */
    .theme-toggle {
      background: var(--toggle-bg);
      border: none;
      cursor: pointer;
      width: 40px; height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      transition: background 0.3s ease, transform 0.3s ease;
      color: var(--color-accent);
    }
    .theme-toggle:hover {
      background: var(--toggle-hover);
      transform: rotate(15deg);
    }

    /* Mobile menu */
    .mobile-toggle {
      display: none;
      background: none;
      border: none;
      cursor: pointer;
      width: 40px; height: 40px;
      position: relative;
      z-index: 110;
    }
    .mobile-toggle span {
      display: block;
      width: 24px; height: 2px;
      background: var(--color-text);
      margin: 6px auto;
      transition: all 0.3s ease;
      border-radius: 1px;
    }
    .mobile-toggle.open span:nth-child(1) {
      transform: rotate(45deg) translate(5px, 6px);
    }
    .mobile-toggle.open span:nth-child(2) { opacity: 0; }
    .mobile-toggle.open span:nth-child(3) {
      transform: rotate(-45deg) translate(5px, -6px);
    }

    .mobile-menu {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: var(--color-bg);
      z-index: 105;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 2rem;
    }
    .mobile-menu.open { display: flex; }
    .mobile-menu .nav-link {
      font-size: 1.6rem;
      font-family: 'Special Elite', monospace;
      opacity: 0;
      transform: translateY(20px);
    }
    .mobile-menu.open .nav-link {
      animation: mobileMenuIn 0.4s ease-out forwards;
    }
    .mobile-menu.open .nav-link:nth-child(1) { animation-delay: 0.05s; }
    .mobile-menu.open .nav-link:nth-child(2) { animation-delay: 0.12s; }
    .mobile-menu.open .nav-link:nth-child(3) { animation-delay: 0.19s; }
    .mobile-menu.open .nav-link:nth-child(4) { animation-delay: 0.26s; }
    .mobile-menu.open .nav-link:nth-child(5) { animation-delay: 0.33s; }

    @keyframes mobileMenuIn {
      to { opacity: 1; transform: translateY(0); }
    }

    @media (max-width: 768px) {
      .nav-links { display: none; }
      .mobile-toggle { display: block; }
    }

    /* ========================================
       HERO SECTION
       ======================================== */
    .hero {
      position: relative;
      margin-bottom: 3rem;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: var(--shadow-page);
    }

    .hero-image {
      width: 100%;
      height: 380px;
      object-fit: cover;
      display: block;
      transition: transform 8s ease;
    }
    .hero:hover .hero-image {
      transform: scale(1.03);
    }

    .hero-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(to bottom, transparent 20%, var(--hero-overlay) 70%, var(--color-bg) 100%);
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 2.5rem;
    }

    .hero-title {
      font-family: 'Special Elite', monospace;
      font-size: 2.8rem;
      color: var(--color-heading-1);
      margin-bottom: 0.3em;
      text-shadow: 0 2px 8px rgba(250,245,235,0.5);
    }

    [data-theme="dark"] .hero-title {
      text-shadow: 0 2px 8px rgba(26,19,13,0.6);
    }

    .hero-subtitle {
      font-family: 'Lora', Georgia, serif;
      font-size: 1.1rem;
      color: var(--color-text-muted);
      font-style: italic;
      opacity: 0;
      animation: fadeSlideIn 0.8s ease-out 1.8s forwards;
    }

    /* Typewriter */
    .typewriter {
      display: inline;
      border-right: 2px solid var(--color-heading-1);
      animation: blinkCursor 0.7s step-end infinite;
      white-space: nowrap;
      overflow: hidden;
    }
    .typewriter.done {
      border-right-color: transparent;
      animation: none;
    }

    @keyframes blinkCursor {
      0%, 100% { border-right-color: var(--color-heading-1); }
      50% { border-right-color: transparent; }
    }

    @keyframes fadeSlideIn {
      to { opacity: 1; transform: translateY(0); }
    }

    /* ========================================
       NOW SECTION — NOTEBOOK STYLE
       ======================================== */
    .now-section {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: 4px 12px 12px 4px;
      padding: 2rem 2.5rem 2rem 3rem;
      position: relative;
      box-shadow: var(--shadow-page);
      overflow: hidden;
    }

    /* Notebook binding */
    .now-section::before {
      content: '';
      position: absolute;
      left: 0; top: 0; bottom: 0;
      width: 3px;
      background: var(--color-heading-4);
      border-radius: 2px 0 0 2px;
    }
    .now-section::after {
      content: '';
      position: absolute;
      left: 14px; top: 0; bottom: 0;
      width: 1px;
      background: rgba(160, 82, 45, 0.15);
    }

    /* Ruled lines */
    .now-section .ruled-bg {
      position: absolute;
      inset: 0;
      background-image: repeating-linear-gradient(
        transparent,
        transparent 27px,
        rgba(160, 82, 45, 0.06) 27px,
        rgba(160, 82, 45, 0.06) 28px
      );
      pointer-events: none;
    }

    .now-section h2 {
      margin-top: 0;
      font-size: 1.5rem;
    }

    .now-columns {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 2rem;
      margin-top: 1rem;
    }

    @media (max-width: 768px) {
      .now-columns { grid-template-columns: 1fr; gap: 1rem; }
    }

    .now-category {
      opacity: 0;
      transform: translateY(16px);
    }
    .now-category.visible {
      animation: fadeSlideUp 0.5s ease-out forwards;
    }
    .now-category:nth-child(1).visible { animation-delay: 0.1s; }
    .now-category:nth-child(2).visible { animation-delay: 0.25s; }
    .now-category:nth-child(3).visible { animation-delay: 0.4s; }

    @keyframes fadeSlideUp {
      to { opacity: 1; transform: translateY(0); }
    }

    .now-category ul {
      list-style: none;
      padding: 0;
    }
    .now-category li {
      position: relative;
      padding-left: 1.1em;
      font-size: 0.95rem;
    }
    .now-category li::before {
      content: '\2022';
      position: absolute;
      left: 0;
      color: var(--color-accent);
    }

    /* ========================================
       LINK CARDS
       ======================================== */
    .link-cards {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
      margin: 2rem 0;
    }

    @media (max-width: 600px) {
      .link-cards { grid-template-columns: 1fr; }
    }

    .link-card {
      display: block;
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: 10px;
      padding: 1.8rem;
      text-decoration: none;
      border-bottom: none;
      transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
      box-shadow: var(--shadow-page);
    }
    .link-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-book-hover);
      border-color: var(--color-accent);
      border-bottom: 1px solid var(--color-accent);
    }
    .link-card h3 {
      margin: 0 0 0.4em;
      font-size: 1.25rem;
    }
    .link-card p {
      color: var(--color-text-muted);
      font-size: 0.92rem;
      margin: 0;
    }
    .link-card .arrow {
      display: inline-block;
      margin-left: 0.5em;
      transition: transform 0.3s ease;
    }
    .link-card:hover .arrow {
      transform: translateX(5px);
    }

    /* ========================================
       CONNECT / SOCIAL
       ======================================== */
    .social-links {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      margin-top: 1rem;
    }
    .social-link {
      display: inline-flex;
      align-items: center;
      gap: 0.5em;
      padding: 0.5em 1em;
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: 8px;
      font-size: 0.88rem;
      color: var(--color-text-muted);
      transition: all 0.25s ease;
      text-decoration: none;
      border-bottom: 1px solid var(--color-border);
    }
    .social-link:hover {
      background: var(--color-bg-alt);
      color: var(--color-text);
      border-color: var(--color-accent);
      border-bottom-color: var(--color-accent);
      transform: translateY(-2px);
    }

    /* ========================================
       BOOKSHELF — 3D CSS
       ======================================== */
    .bookshelf-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }
    .bookshelf-header h1 {
      margin: 0;
    }
    .book-count {
      font-family: 'Lora', serif;
      color: var(--color-text-muted);
      font-size: 1rem;
      font-weight: 400;
    }

    /* View toggle */
    .view-toggle {
      display: flex;
      gap: 0;
      border: 1px solid var(--color-border);
      border-radius: 8px;
      overflow: hidden;
    }
    .view-btn {
      background: transparent;
      border: none;
      padding: 0.5em 1em;
      cursor: pointer;
      color: var(--color-text-muted);
      font-family: 'Lora', serif;
      font-size: 0.85rem;
      transition: all 0.25s ease;
    }
    .view-btn.active {
      background: var(--color-accent);
      color: #fff;
    }
    .view-btn:hover:not(.active) {
      background: var(--color-bg-alt);
    }

    /* Filter pills */
    .filter-pills {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }
    .filter-pill {
      background: transparent;
      border: 1px solid var(--color-border);
      border-radius: 20px;
      padding: 0.35em 1em;
      cursor: pointer;
      font-family: 'Lora', serif;
      font-size: 0.85rem;
      color: var(--color-text-muted);
      transition: all 0.25s ease;
    }
    .filter-pill:hover {
      border-color: var(--color-accent);
      color: var(--color-text);
    }
    .filter-pill.active {
      background: var(--color-accent);
      border-color: var(--color-accent);
      color: #fff;
    }

    /* Shelf row */
    .shelf-group {
      margin-bottom: 3rem;
      opacity: 0;
      transform: translateY(20px);
    }
    .shelf-group.visible {
      animation: fadeSlideUp 0.6s ease-out forwards;
    }

    .shelf-year-label {
      font-family: 'Special Elite', monospace;
      font-size: 1.1rem;
      color: var(--color-text-muted);
      margin-bottom: 0.8rem;
      padding-left: 0.3rem;
      letter-spacing: 0.08em;
    }

    .shelf-books {
      display: flex;
      flex-wrap: wrap;
      gap: 1.2rem;
      padding: 1rem 1rem 0;
      min-height: 230px;
      align-items: flex-end;
    }

    .shelf-plank {
      height: 18px;
      background: var(--shelf-gradient);
      border-radius: 2px;
      box-shadow: var(--shelf-shadow);
      position: relative;
      margin-top: -2px;
    }
    .shelf-plank::after {
      content: '';
      position: absolute;
      bottom: -6px; left: 0; right: 0;
      height: 6px;
      background: var(--shelf-lip);
      border-radius: 0 0 3px 3px;
    }

    /* Individual 3D book */
    .book-3d {
      width: 120px;
      cursor: pointer;
      perspective: 800px;
      transition: transform 0.35s ease;
    }
    .book-3d:hover {
      transform: translateY(-10px);
    }

    .book-inner {
      position: relative;
      width: 120px;
      height: 180px;
      transform-style: preserve-3d;
      transform: rotateY(-8deg);
      transition: transform 0.4s ease, box-shadow 0.4s ease;
    }
    .book-3d:hover .book-inner {
      transform: rotateY(-18deg) translateZ(10px);
    }

    .book-cover {
      position: absolute;
      inset: 0;
      border-radius: 2px 4px 4px 2px;
      overflow: hidden;
      box-shadow: var(--shadow-book);
      transition: box-shadow 0.4s ease;
      backface-visibility: hidden;
    }
    .book-3d:hover .book-cover {
      box-shadow: var(--shadow-book-hover);
    }

    .book-cover img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .book-spine {
      position: absolute;
      left: 0; top: 0; bottom: 0;
      width: 16px;
      transform: rotateY(90deg) translateZ(0px) translateX(-8px);
      background: linear-gradient(to right, #4a3020, #6b4226, #5a3520);
      border-radius: 2px 0 0 2px;
    }

    .book-top {
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 16px;
      transform: rotateX(-90deg) translateY(-8px);
      background: linear-gradient(to bottom, #f0e6d0, #e8dcc4);
    }

    [data-theme="dark"] .book-top {
      background: linear-gradient(to bottom, #5a4a3a, #4a3a2a);
    }

    .book-title {
      font-family: 'Lora', serif;
      font-size: 0.78rem;
      color: var(--color-text-muted);
      text-align: center;
      margin-top: 0.6rem;
      line-height: 1.3;
      max-width: 120px;
    }

    @media (max-width: 600px) {
      .book-3d { width: 95px; }
      .book-inner { width: 95px; height: 142px; }
      .book-title { max-width: 95px; font-size: 0.7rem; }
      .shelf-books { gap: 0.8rem; }
    }

    /* ========================================
       READING TIMELINE
       ======================================== */
    .timeline-container {
      position: relative;
      padding: 2rem 0 2rem 3rem;
    }

    .timeline-line {
      position: absolute;
      left: 14px; top: 0; bottom: 0;
      width: 2px;
      background: var(--timeline-line);
    }

    .timeline-year-group {
      margin-bottom: 2.5rem;
      position: relative;
      opacity: 0;
      transform: translateX(-15px);
    }
    .timeline-year-group.visible {
      animation: timelineIn 0.5s ease-out forwards;
    }

    @keyframes timelineIn {
      to { opacity: 1; transform: translateX(0); }
    }

    .timeline-year-dot {
      position: absolute;
      left: -3rem;
      top: 0.15em;
      width: 14px; height: 14px;
      background: var(--timeline-dot);
      border: 3px solid var(--timeline-dot-border);
      border-radius: 50%;
      box-shadow: 0 0 0 2px var(--timeline-dot);
    }

    .timeline-year-label {
      font-family: 'Special Elite', monospace;
      font-size: 1.3rem;
      color: var(--color-heading-2);
      margin-bottom: 0.8rem;
    }

    .timeline-books {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .timeline-book {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: 8px;
      padding: 0.5rem 1rem 0.5rem 0.5rem;
      transition: all 0.25s ease;
      cursor: pointer;
    }
    .timeline-book:hover {
      transform: translateX(5px);
      border-color: var(--color-accent);
      box-shadow: var(--shadow-page);
    }

    .timeline-book img {
      width: 36px; height: 54px;
      object-fit: cover;
      border-radius: 2px;
      box-shadow: 1px 2px 4px rgba(0,0,0,0.15);
    }

    .timeline-book-info {
      font-size: 0.85rem;
    }
    .timeline-book-title {
      font-weight: 600;
      color: var(--color-text);
      line-height: 1.3;
    }
    .timeline-book-author {
      color: var(--color-text-muted);
      font-size: 0.78rem;
      font-style: italic;
    }

    /* ========================================
       BOOK DETAIL PAGE
       ======================================== */
    .book-detail {
      max-width: 700px;
      margin: 0 auto;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 0.4em;
      font-size: 0.9rem;
      color: var(--color-text-muted);
      margin-bottom: 2rem;
      border-bottom: none;
    }
    .back-link:hover { color: var(--color-link-hover); border-bottom: none; }

    .book-detail-cover {
      display: block;
      max-width: 240px;
      margin: 0 auto 2rem;
      border-radius: 4px;
      box-shadow: var(--shadow-book-hover);
      transition: transform 0.4s ease;
    }
    .book-detail-cover:hover {
      transform: perspective(800px) rotateY(-8deg) scale(1.02);
    }

    .book-meta {
      text-align: center;
      margin-bottom: 2rem;
    }
    .book-meta h1 { font-size: 2rem; margin-bottom: 0.3em; }
    .book-meta .author {
      font-style: italic;
      color: var(--color-text-muted);
      font-size: 1.05rem;
      margin-bottom: 0.6em;
    }
    .year-badge {
      display: inline-block;
      background: var(--color-bg-alt);
      border: 1px solid var(--color-border);
      border-radius: 20px;
      padding: 0.25em 1em;
      font-size: 0.85rem;
      color: var(--color-text-muted);
      font-family: 'Special Elite', monospace;
    }

    .notes-placeholder {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: 10px;
      padding: 2rem;
      text-align: center;
      color: var(--color-text-muted);
      font-style: italic;
      position: relative;
    }
    /* Folded corner */
    .notes-placeholder::before {
      content: '';
      position: absolute;
      top: 0; right: 0;
      width: 30px; height: 30px;
      background: linear-gradient(135deg, var(--color-bg) 50%, var(--color-border) 50%);
      border-radius: 0 10px 0 0;
    }

    /* ========================================
       WRITING PAGE
       ======================================== */
    .writing-tabs {
      display: flex;
      gap: 0;
      margin-bottom: 2rem;
      border-bottom: 1px solid var(--color-border);
    }
    .writing-tab {
      background: none;
      border: none;
      padding: 0.8em 1.5em;
      cursor: pointer;
      font-family: 'Special Elite', monospace;
      font-size: 1rem;
      color: var(--color-text-muted);
      position: relative;
      transition: color 0.25s ease;
    }
    .writing-tab.active {
      color: var(--color-heading-2);
    }
    .writing-tab::after {
      content: '';
      position: absolute;
      bottom: -1px; left: 0; right: 0;
      height: 2px;
      background: transparent;
      transition: background 0.25s ease;
    }
    .writing-tab.active::after {
      background: var(--color-accent);
    }

    .empty-state {
      text-align: center;
      padding: 4rem 2rem;
      color: var(--color-text-muted);
    }
    .empty-state .pen-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
      opacity: 0.4;
    }
    .empty-state p {
      font-family: 'Special Elite', monospace;
      font-style: italic;
      font-size: 1.1rem;
    }

    /* ========================================
       ABOUT PAGE
       ======================================== */
    .about-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
      margin: 2rem 0;
    }
    @media (max-width: 768px) {
      .about-grid { grid-template-columns: 1fr; }
    }

    .about-card {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: 10px;
      padding: 1.5rem;
      box-shadow: var(--shadow-page);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .about-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-book-hover);
    }
    .about-card .card-icon {
      font-size: 1.5rem;
      margin-bottom: 0.6rem;
    }
    .about-card h3 { margin: 0 0 0.6em; font-size: 1.2rem; }
    .about-card p, .about-card ul {
      font-size: 0.92rem;
      color: var(--color-text-muted);
    }

    /* ========================================
       404 PAGE
       ======================================== */
    .not-found {
      text-align: center;
      padding: 6rem 2rem;
      position: relative;
    }
    .not-found .big-404 {
      font-family: 'Special Elite', monospace;
      font-size: 10rem;
      color: var(--color-border);
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      z-index: -1;
      animation: float 6s ease-in-out infinite;
      opacity: 0.3;
    }
    @keyframes float {
      0%, 100% { transform: translate(-50%, -50%); }
      50% { transform: translate(-50%, calc(-50% - 12px)); }
    }
    .not-found h1 { position: relative; z-index: 1; font-size: 1.8rem; }
    .not-found p {
      position: relative; z-index: 1;
      color: var(--color-text-muted);
      font-style: italic;
      margin: 1rem 0 2rem;
    }
    .home-link-btn {
      display: inline-block;
      padding: 0.6em 1.5em;
      background: var(--color-accent);
      color: #fff;
      border-radius: 8px;
      font-family: 'Lora', serif;
      font-weight: 500;
      transition: all 0.25s ease;
      border-bottom: none;
    }
    .home-link-btn:hover {
      background: var(--color-heading-1);
      transform: translateY(-2px);
      color: #fff;
      border-bottom: none;
    }

    /* ========================================
       SECTION DIVIDER
       ======================================== */
    .divider {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 3rem 0;
      color: var(--color-border);
      gap: 1rem;
    }
    .divider::before, .divider::after {
      content: '';
      flex: 1;
      height: 1px;
      background: var(--color-border);
    }
    .divider-icon {
      font-size: 0.8rem;
      opacity: 0.6;
    }

    /* ========================================
       FOOTER
       ======================================== */
    .site-footer {
      background: var(--color-bg-alt);
      border-top: 1px solid var(--color-border);
      padding: 2.5rem 1.5rem;
      text-align: center;
      position: relative;
      z-index: 2;
      transition: background 0.4s ease, border-color 0.4s ease;
    }
    .footer-socials {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 1.2rem;
    }
    .footer-social-link {
      color: var(--color-text-muted);
      font-size: 1.1rem;
      transition: color 0.25s ease, transform 0.25s ease;
      border-bottom: none;
      padding: 0.3em;
    }
    .footer-social-link:hover {
      color: var(--color-accent);
      transform: translateY(-2px);
      border-bottom: none;
    }
    .footer-tagline {
      font-family: 'Special Elite', monospace;
      font-style: italic;
      color: var(--color-text-muted);
      font-size: 0.9rem;
      margin-bottom: 0.4rem;
    }
    .footer-copy {
      font-size: 0.8rem;
      color: var(--color-text-muted);
      opacity: 0.7;
    }

    /* ========================================
       UTILITIES
       ======================================== */
    .hidden { display: none !important; }
    .sr-only {
      position: absolute; width: 1px; height: 1px;
      padding: 0; margin: -1px; overflow: hidden;
      clip: rect(0,0,0,0); border: 0;
    }
  </style>
</head>

<body>
  <!-- ============ NAVIGATION ============ -->
  <nav class="site-nav" id="mainNav">
    <div class="nav-inner">
      <a href="#" class="nav-brand" onclick="showPage('home'); return false;">Nostem Koempassu</a>
      <div class="nav-links">
        <a href="#" class="nav-link active" data-page="home" onclick="showPage('home'); return false;">Home</a>
        <a href="#" class="nav-link" data-page="books" onclick="showPage('books'); return false;">Books</a>
        <a href="#" class="nav-link" data-page="writing" onclick="showPage('writing'); return false;">Writing</a>
        <a href="#" class="nav-link" data-page="about" onclick="showPage('about'); return false;">About</a>
        <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark mode" id="themeToggle">
          <span id="themeIcon"></span>
        </button>
      </div>
      <button class="mobile-toggle" id="mobileToggle" onclick="toggleMobileMenu()" aria-label="Menu">
        <span></span><span></span><span></span>
      </button>
    </div>
  </nav>

  <!-- Mobile menu -->
  <div class="mobile-menu" id="mobileMenu">
    <a href="#" class="nav-link" onclick="showPage('home'); toggleMobileMenu(); return false;">Home</a>
    <a href="#" class="nav-link" onclick="showPage('books'); toggleMobileMenu(); return false;">Books</a>
    <a href="#" class="nav-link" onclick="showPage('writing'); toggleMobileMenu(); return false;">Writing</a>
    <a href="#" class="nav-link" onclick="showPage('about'); toggleMobileMenu(); return false;">About</a>
    <button class="theme-toggle" onclick="toggleTheme()" style="margin-top:1rem" aria-label="Toggle dark mode">
      <span id="themeIconMobile"></span>
    </button>
  </div>

  <!-- ============ HOME PAGE ============ -->
  <div class="page-content" id="page-home">
    <div class="page-container">
      <!-- Hero -->
      <div class="hero">
        <img src="https://images.stockcake.com/public/b/4/9/b49748b1-10d3-4497-8c75-2850cd757fc6/vintage-writer-s-desk-stockcake.jpg"
             alt="Vintage typewriter on a warm-lit desk" class="hero-image">
        <div class="hero-overlay">
          <div class="hero-title"><span class="typewriter" id="typewriter"></span></div>
          <p class="hero-subtitle">Builder, thinker, explorer of consciousness, systems, and personal sovereignty.</p>
        </div>
      </div>

      <!-- Now Section -->
      <section>
        <div class="now-section" id="nowSection">
          <div class="ruled-bg"></div>
          <h2>Now</h2>
          <div class="now-columns">
            <div class="now-category" id="now-1">
              <h4>Exploring</h4>
              <ul>
                <li>Infinite Banking Concept & private financial systems</li>
                <li>Natural vs. synthetic fabrics and their effects on the mind/body/spirit complex</li>
              </ul>
            </div>
            <div class="now-category" id="now-2">
              <h4>Building</h4>
              <ul>
                <li>This personal site and other side projects</li>
                <li>Restructuring my light environment &mdash; removing LEDs, opting for incandescents</li>
              </ul>
            </div>
            <div class="now-category" id="now-3">
              <h4>Reading</h4>
              <ul>
                <li>Deep dives into consciousness and metaphysics</li>
                <li>Classical fiction</li>
                <li>Revisionist history & unique historical accounts</li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- Link Cards -->
      <div class="link-cards">
        <a href="#" class="link-card" onclick="showPage('writing'); return false;">
          <h3>Writing <span class="arrow">&rarr;</span></h3>
          <p>Essays, poems, and thoughts in progress</p>
        </a>
        <a href="#" class="link-card" onclick="showPage('books'); return false;">
          <h3>Bookshelf <span class="arrow">&rarr;</span></h3>
          <p>21 books across consciousness, sovereignty, and systems</p>
        </a>
      </div>

      <!-- Connect -->
      <section>
        <h3>Connect</h3>
        <div class="social-links">
          <a href="https://x.com/TheAl_Mo" class="social-link" target="_blank">&#x1D54F; @TheAl_Mo</a>
          <a href="https://github.com/Nostem" class="social-link" target="_blank">&#9881; GitHub</a>
          <a href="https://nostem.substack.com" class="social-link" target="_blank">&#9993; Substack</a>
        </div>
      </section>
    </div>
  </div>

  <!-- ============ BOOKS PAGE ============ -->
  <div class="page-content hidden" id="page-books">
    <div class="wide-container">
      <div class="bookshelf-header">
        <h1>Bookshelf <span class="book-count">(21)</span></h1>
        <div class="view-toggle">
          <button class="view-btn active" id="shelfViewBtn" onclick="switchView('shelf')">Shelf</button>
          <button class="view-btn" id="timelineViewBtn" onclick="switchView('timeline')">Timeline</button>
        </div>
      </div>

      <!-- Filters -->
      <div class="filter-pills" id="filterPills"></div>

      <!-- Shelf View -->
      <div id="shelfView"></div>

      <!-- Timeline View -->
      <div id="timelineView" class="hidden"></div>
    </div>
  </div>

  <!-- ============ BOOK DETAIL PAGE ============ -->
  <div class="page-content hidden" id="page-book-detail">
    <div class="page-container">
      <div class="book-detail" id="bookDetail"></div>
    </div>
  </div>

  <!-- ============ WRITING PAGE ============ -->
  <div class="page-content hidden" id="page-writing">
    <div class="page-container">
      <h1>Writing</h1>
      <div class="writing-tabs">
        <button class="writing-tab active">Essays</button>
        <button class="writing-tab">Poems</button>
        <button class="writing-tab">Random</button>
      </div>
      <div class="empty-state">
        <div class="pen-icon">&#9997;</div>
        <p>Words are being gathered...</p>
        <p style="font-family: 'Lora', serif; font-size: 0.9rem; margin-top: 1rem; opacity: 0.7;">
          Essays, poems, and reflections coming soon.
        </p>
      </div>
    </div>
  </div>

  <!-- ============ ABOUT PAGE ============ -->
  <div class="page-content hidden" id="page-about">
    <div class="page-container">
      <h1>About</h1>
      <p>
        I'm <strong>Nostem Koempassu</strong> &mdash; builder, thinker, and explorer of ideas around
        consciousness, systems, and personal sovereignty.
      </p>
      <p>
        This is my digital homestead: a living collection of what I'm reading,
        writing, and working on. It's a page in progress, like everything else.
      </p>

      <div class="divider"><span class="divider-icon">&bull;</span></div>

      <div class="about-grid">
        <div class="about-card">
          <div class="card-icon">&#127758;</div>
          <h3>Exploring</h3>
          <ul>
            <li>Infinite Banking & private finance</li>
            <li>Natural materials & analog living</li>
            <li>Consciousness & metaphysics</li>
          </ul>
        </div>
        <div class="about-card">
          <div class="card-icon">&#128295;</div>
          <h3>Building</h3>
          <ul>
            <li>This personal site</li>
            <li>Side projects in code</li>
            <li>A sovereignty-first lifestyle</li>
          </ul>
        </div>
        <div class="about-card">
          <div class="card-icon">&#128214;</div>
          <h3>Reading</h3>
          <ul>
            <li>The Law of One & Ra Material</li>
            <li>Classic fiction & myth</li>
            <li>Revisionist history</li>
          </ul>
        </div>
      </div>

      <div class="divider"><span class="divider-icon">&bull;</span></div>

      <h3>Connect</h3>
      <div class="social-links">
        <a href="https://x.com/TheAl_Mo" class="social-link" target="_blank">&#x1D54F; @TheAl_Mo</a>
        <a href="https://github.com/Nostem" class="social-link" target="_blank">&#9881; GitHub</a>
        <a href="https://nostem.substack.com" class="social-link" target="_blank">&#9993; Substack</a>
      </div>
    </div>
  </div>

  <!-- ============ 404 PAGE ============ -->
  <div class="page-content hidden" id="page-404">
    <div class="page-container">
      <div class="not-found">
        <div class="big-404">404</div>
        <h1>This page has wandered off the path</h1>
        <p>Perhaps it's exploring somewhere beyond the homestead.</p>
        <a href="#" class="home-link-btn" onclick="showPage('home'); return false;">Return to the homestead</a>
      </div>
    </div>
  </div>

  <!-- ============ FOOTER ============ -->
  <footer class="site-footer">
    <div class="footer-socials">
      <a href="https://x.com/TheAl_Mo" class="footer-social-link" target="_blank" title="X / Twitter">&#x1D54F;</a>
      <a href="https://github.com/Nostem" class="footer-social-link" target="_blank" title="GitHub">&#9881;</a>
      <a href="https://nostem.substack.com" class="footer-social-link" target="_blank" title="Substack">&#9993;</a>
    </div>
    <div class="footer-tagline">Built with curiosity.</div>
    <div class="footer-copy">&copy; <span id="footerYear"></span> Nostem Koempassu</div>
  </footer>

  <script>
    // ========================================
    // BOOK DATA — All 21 books
    // ========================================
    const books = [
      { slug: "1913", title: "1913: In Search of the World Before the Great War", author: "Charles Emmerson", coverUrl: "https://m.media-amazon.com/images/I/51SxNN4yy4L._SY445_SX342_ML2_.jpg", yearRead: 2026 },
      { slug: "becoming-your-own-banker", title: "Becoming Your Own Banker", author: "R. Nelson Nash", coverUrl: "https://m.media-amazon.com/images/I/81AbCHNRvEL._SL1500_.jpg", yearRead: 2025 },
      { slug: "propaganda", title: "Propaganda", author: "Edward Bernays", coverUrl: "https://m.media-amazon.com/images/I/61nXlYRyFtL._SL1491_.jpg", yearRead: 2025 },
      { slug: "hero-thousand-faces", title: "The Hero With a Thousand Faces", author: "Joseph Campbell", coverUrl: "https://m.media-amazon.com/images/I/81aJChDqSfL._SL1500_.jpg", yearRead: 2025 },
      { slug: "art-of-war", title: "The Art of War", author: "Sun Tzu", coverUrl: "https://m.media-amazon.com/images/I/713G4AE4ssL._SL1499_.jpg", yearRead: 2025 },
      { slug: "atomic-habits", title: "Atomic Habits", author: "James Clear", coverUrl: "https://m.media-amazon.com/images/I/81kg51XRc1L._SL1500_.jpg", yearRead: 2025 },
      { slug: "4-hour-body", title: "The 4-Hour Body", author: "Tim Ferriss", coverUrl: "https://images1.penguinrandomhouse.com/cover/9780307463630", yearRead: 2025 },
      { slug: "unlimited-memory", title: "Unlimited Memory", author: "Kevin Horsley", coverUrl: "https://covers.openlibrary.org/b/isbn/9781631619984-L.jpg", yearRead: 2025 },
      { slug: "short-history-nearly-everything", title: "A Short History of Nearly Everything", author: "Bill Bryson", coverUrl: "https://covers.openlibrary.org/b/isbn/9780767908177-L.jpg", yearRead: 2025 },
      { slug: "summoning-the-demon", title: "Summoning the Demon", author: "", coverUrl: "https://m.media-amazon.com/images/I/81Hyab0cRQL._SL1500_.jpg", yearRead: 2024 },
      { slug: "a-wanderers-handbook", title: "A Wanderer's Handbook", author: "Carla Rueckert", coverUrl: "https://m.media-amazon.com/images/I/618d51-Lh0L._SL1000_.jpg", yearRead: 2024 },
      { slug: "children-of-the-law-of-one", title: "Children of the Law of One", author: "", coverUrl: "https://m.media-amazon.com/images/I/41MG2ZGCA7L.jpg", yearRead: 2024 },
      { slug: "hypnotist-journey-avalon", title: "A Hypnotist's Journey to Avalon", author: "", coverUrl: "https://m.media-amazon.com/images/I/41kxPck7r8L._SY445_SX342_ML2_.jpg", yearRead: 2024 },
      { slug: "emerald-tablets-of-thoth", title: "The Emerald Tablets of Thoth", author: "", coverUrl: "https://m.media-amazon.com/images/I/811AXSSpk3L._SL1499_.jpg", yearRead: 2023 },
      { slug: "communist-manifesto", title: "The Communist Manifesto", author: "Karl Marx", coverUrl: "https://m.media-amazon.com/images/I/61znGCVUiyL._SL1500_.jpg", yearRead: 2023 },
      { slug: "richest-man-in-babylon", title: "The Richest Man in Babylon", author: "George Clason", coverUrl: "https://m.media-amazon.com/images/I/71PxZSoUitL._SL1500_.jpg", yearRead: 2023 },
      { slug: "the-impersonal-life", title: "The Impersonal Life", author: "", coverUrl: "https://m.media-amazon.com/images/I/81Cga9q2ufL._SL1500_.jpg", yearRead: 2021 },
      { slug: "law-of-one", title: "The Law of One", author: "", coverUrl: "https://m.media-amazon.com/images/I/71YBS+FBNLL._SL1500_.jpg", yearRead: 2020 },
      { slug: "1984", title: "1984", author: "George Orwell", coverUrl: "https://m.media-amazon.com/images/I/81qZ5kGMQ1L._SL1500_.jpg", yearRead: 2017 },
      { slug: "the-stand", title: "The Stand", author: "Stephen King", coverUrl: "https://m.media-amazon.com/images/I/81LTcWSIgkL._SL1500_.jpg", yearRead: 2017 },
      { slug: "metabolic-typing-diet", title: "The Metabolic Typing Diet", author: "", coverUrl: "https://m.media-amazon.com/images/I/81dD6yByLeL._SL1500_.jpg", yearRead: 2014 },
    ];

    // ========================================
    // THEME MANAGEMENT
    // ========================================
    function getTheme() {
      return document.documentElement.getAttribute('data-theme') || 'light';
    }

    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
      updateThemeIcons();
    }

    function toggleTheme() {
      setTheme(getTheme() === 'dark' ? 'light' : 'dark');
    }

    function updateThemeIcons() {
      const isDark = getTheme() === 'dark';
      const icon = isDark ? '\u2600\uFE0F' : '\uD83C\uDF19';
      document.getElementById('themeIcon').textContent = icon;
      const mobileIcon = document.getElementById('themeIconMobile');
      if (mobileIcon) mobileIcon.textContent = icon;
    }

    // Init theme
    (function() {
      const saved = localStorage.getItem('theme');
      if (saved) setTheme(saved);
      else setTheme('light');
    })();

    // ========================================
    // NAVIGATION & PAGE ROUTING
    // ========================================
    let currentPage = 'home';

    function showPage(pageName, skipAnimation) {
      if (pageName === currentPage && !skipAnimation) return;

      // Exit animation
      const currentEl = document.getElementById('page-' + currentPage);
      if (currentEl && !skipAnimation) {
        currentEl.classList.add('page-exit');
        setTimeout(() => {
          currentEl.classList.add('hidden');
          currentEl.classList.remove('page-exit');
          activatePage(pageName);
        }, 200);
      } else {
        if (currentEl) currentEl.classList.add('hidden');
        activatePage(pageName);
      }
    }

    function activatePage(pageName) {
      currentPage = pageName;
      const pageEl = document.getElementById('page-' + pageName);
      if (pageEl) {
        pageEl.classList.remove('hidden');
        // Re-trigger enter animation
        pageEl.style.animation = 'none';
        pageEl.offsetHeight; // force reflow
        pageEl.style.animation = '';
      }

      // Update nav active state
      document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.toggle('active', link.getAttribute('data-page') === pageName);
      });

      // Scroll to top
      window.scrollTo({ top: 0, behavior: 'instant' });

      // Trigger scroll animations for new page
      setTimeout(triggerScrollAnimations, 100);

      // If books page, render bookshelf
      if (pageName === 'books') renderBooks();

      // If home, restart typewriter
      if (pageName === 'home') startTypewriter();
    }

    // Mobile menu
    function toggleMobileMenu() {
      const menu = document.getElementById('mobileMenu');
      const toggle = document.getElementById('mobileToggle');
      const isOpen = menu.classList.contains('open');
      menu.classList.toggle('open');
      toggle.classList.toggle('open');
      document.body.style.overflow = isOpen ? '' : 'hidden';
    }

    // Nav scroll effect
    window.addEventListener('scroll', () => {
      document.getElementById('mainNav').classList.toggle('scrolled', window.scrollY > 20);
      triggerScrollAnimations();
    });

    // ========================================
    // TYPEWRITER EFFECT
    // ========================================
    let typewriterTimeout;
    function startTypewriter() {
      const el = document.getElementById('typewriter');
      if (!el) return;
      clearTimeout(typewriterTimeout);
      el.textContent = '';
      el.classList.remove('done');
      const text = "Hello. I'm Nostem.";
      let i = 0;
      function type() {
        if (i < text.length) {
          el.textContent = text.slice(0, i + 1);
          i++;
          typewriterTimeout = setTimeout(type, 85);
        } else {
          setTimeout(() => el.classList.add('done'), 2000);
        }
      }
      setTimeout(type, 600);
    }

    // ========================================
    // SCROLL ANIMATIONS
    // ========================================
    function triggerScrollAnimations() {
      const elements = document.querySelectorAll('.now-category, .shelf-group, .timeline-year-group');
      elements.forEach(el => {
        const rect = el.getBoundingClientRect();
        if (rect.top < window.innerHeight - 60) {
          el.classList.add('visible');
        }
      });
    }

    // ========================================
    // BOOKS — RENDERING
    // ========================================
    let activeYear = null; // null = All
    let activeView = 'shelf';

    function getBooksByYear(filterYear) {
      const filtered = filterYear ? books.filter(b => b.yearRead === filterYear) : books;
      const grouped = {};
      filtered.forEach(b => {
        if (!grouped[b.yearRead]) grouped[b.yearRead] = [];
        grouped[b.yearRead].push(b);
      });
      return Object.keys(grouped)
        .sort((a, b) => b - a)
        .map(y => ({ year: parseInt(y), books: grouped[y] }));
    }

    function getYears() {
      return [...new Set(books.map(b => b.yearRead))].sort((a, b) => b - a);
    }

    function renderFilterPills() {
      const container = document.getElementById('filterPills');
      const years = getYears();
      let html = `<button class="filter-pill ${activeYear === null ? 'active' : ''}" onclick="filterBooks(null)">All (${books.length})</button>`;
      years.forEach(y => {
        const count = books.filter(b => b.yearRead === y).length;
        html += `<button class="filter-pill ${activeYear === y ? 'active' : ''}" onclick="filterBooks(${y})">${y} (${count})</button>`;
      });
      container.innerHTML = html;
    }

    function filterBooks(year) {
      activeYear = year;
      renderFilterPills();
      if (activeView === 'shelf') renderShelfView();
      else renderTimelineView();
    }

    function switchView(view) {
      activeView = view;
      document.getElementById('shelfViewBtn').classList.toggle('active', view === 'shelf');
      document.getElementById('timelineViewBtn').classList.toggle('active', view === 'timeline');
      document.getElementById('shelfView').classList.toggle('hidden', view !== 'shelf');
      document.getElementById('timelineView').classList.toggle('hidden', view !== 'timeline');
      if (view === 'shelf') renderShelfView();
      else renderTimelineView();
    }

    function renderShelfView() {
      const container = document.getElementById('shelfView');
      const groups = getBooksByYear(activeYear);
      let html = '';
      groups.forEach((group, gi) => {
        html += `<div class="shelf-group" style="animation-delay: ${gi * 0.15}s">`;
        html += `<div class="shelf-year-label">${group.year}</div>`;
        html += `<div class="shelf-books">`;
        group.books.forEach((book, bi) => {
          html += `
            <div class="book-3d" onclick="showBookDetail('${book.slug}')" title="${book.title}" style="animation-delay: ${(gi * 0.15) + (bi * 0.08)}s">
              <div class="book-inner">
                <div class="book-spine"></div>
                <div class="book-top"></div>
                <div class="book-cover">
                  <img src="${book.coverUrl}" alt="${book.title}" loading="lazy">
                </div>
              </div>
            </div>`;
        });
        html += `</div>`;
        html += `<div class="shelf-plank"></div>`;
        html += `</div>`;
      });
      container.innerHTML = html;
      setTimeout(triggerScrollAnimations, 50);
    }

    function renderTimelineView() {
      const container = document.getElementById('timelineView');
      const groups = getBooksByYear(activeYear);
      let html = '<div class="timeline-container"><div class="timeline-line"></div>';
      groups.forEach((group, gi) => {
        html += `<div class="timeline-year-group" style="animation-delay: ${gi * 0.12}s">`;
        html += `<div class="timeline-year-dot"></div>`;
        html += `<div class="timeline-year-label">${group.year}</div>`;
        html += `<div class="timeline-books">`;
        group.books.forEach(book => {
          html += `
            <div class="timeline-book" onclick="showBookDetail('${book.slug}')">
              <img src="${book.coverUrl}" alt="${book.title}" loading="lazy">
              <div class="timeline-book-info">
                <div class="timeline-book-title">${book.title}</div>
                ${book.author ? `<div class="timeline-book-author">${book.author}</div>` : ''}
              </div>
            </div>`;
        });
        html += `</div></div>`;
      });
      html += '</div>';
      container.innerHTML = html;
      setTimeout(triggerScrollAnimations, 50);
    }

    function renderBooks() {
      renderFilterPills();
      if (activeView === 'shelf') renderShelfView();
      else renderTimelineView();
    }

    // ========================================
    // BOOK DETAIL
    // ========================================
    function showBookDetail(slug) {
      const book = books.find(b => b.slug === slug);
      if (!book) return;

      const container = document.getElementById('bookDetail');
      container.innerHTML = `
        <a href="#" class="back-link" onclick="showPage('books'); return false;">&larr; Back to Bookshelf</a>
        <img src="${book.coverUrl}" alt="${book.title}" class="book-detail-cover">
        <div class="book-meta">
          <h1>${book.title}</h1>
          ${book.author ? `<div class="author">by ${book.author}</div>` : ''}
          <span class="year-badge">Read in ${book.yearRead}</span>
        </div>
        <div class="notes-placeholder">
          <p>Notes and reflections coming soon...</p>
        </div>
      `;

      // Transition to book detail page
      const currentEl = document.getElementById('page-' + currentPage);
      currentEl.classList.add('page-exit');
      setTimeout(() => {
        currentEl.classList.add('hidden');
        currentEl.classList.remove('page-exit');
        currentPage = 'book-detail';
        const detailEl = document.getElementById('page-book-detail');
        detailEl.classList.remove('hidden');
        detailEl.style.animation = 'none';
        detailEl.offsetHeight;
        detailEl.style.animation = '';
        window.scrollTo({ top: 0, behavior: 'instant' });
      }, 200);
    }

    // ========================================
    // INIT
    // ========================================
    document.getElementById('footerYear').textContent = new Date().getFullYear();
    startTypewriter();
    setTimeout(triggerScrollAnimations, 600);

    // Writing tabs interaction
    document.querySelectorAll('.writing-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.writing-tab').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
      });
    });
  </script>
</body>
</html>
